<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 dataframe（数据框）和tibble | R与tidyverse——数据分析入门</title>
  <meta name="description" content="这是我b站R与tidyverse教程的配套资源" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 dataframe（数据框）和tibble | R与tidyverse——数据分析入门" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="这是我b站R与tidyverse教程的配套资源" />
  <meta name="github-repo" content="TianyiShi2001/R-Tutorial-Resorces" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 dataframe（数据框）和tibble | R与tidyverse——数据分析入门" />
  
  <meta name="twitter:description" content="这是我b站R与tidyverse教程的配套资源" />
  

<meta name="author" content="石天熠" />


<meta name="date" content="2019-07-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vectors-logicals-and-functions.html">
<link rel="next" href="graphics.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
  (function(d) {
    var config = {
      kitId: 'tob8xaq',
      scriptTimeout: 3000,
      async: true
    },
    h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
  })(document);
</script>
<script src="https://hypothes.is/embed.js" async></script>
<style>
.book.font-family-0 {
  font-family: Georgia, source-han-serif-sc, serif;
  font-weight: 400;
  font-style: normal;
}

.book.font-family-1 {
  font-family: Arial, Helvetica, source-han-sans-simplified-c, sans-serif, sans-serif;
  font-weight: 300;
  font-style: normal;
}
</style>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>欢迎</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#简介"><i class="fa fa-check"></i>简介</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#说明"><i class="fa fa-check"></i>使用说明</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#e69cace4b9a6e79a84e7bb93e69e84"><i class="fa fa-check"></i>本书的结构</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#e59ca8e69cace4b9a6e4bda0e4b88de4bc9ae5ada6e588b0efbc9a"><i class="fa fa-check"></i>在本书你不会学到：</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#e78988e69d83e9a1b5"><i class="fa fa-check"></i>版权页</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro-and-installation.html"><a href="intro-and-installation.html"><i class="fa fa-check"></i><b>1</b> R和RStudio介绍和安装教程</a><ul>
<li class="chapter" data-level="1.1" data-path="intro-and-installation.html"><a href="intro-and-installation.html#r"><i class="fa fa-check"></i><b>1.1</b> 什么是R</a></li>
<li class="chapter" data-level="1.2" data-path="intro-and-installation.html"><a href="intro-and-installation.html#rrstudio"><i class="fa fa-check"></i><b>1.2</b> 安装R和RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro-and-installation.html"><a href="intro-and-installation.html#r"><i class="fa fa-check"></i><b>1.2.1</b> 安装R</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro-and-installation.html"><a href="intro-and-installation.html#rstudio"><i class="fa fa-check"></i><b>1.2.2</b> 安装RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro-and-installation.html"><a href="intro-and-installation.html#youshi"><i class="fa fa-check"></i><b>1.3</b> 为什么使用R，R与其他统计软件的比较</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-help.html"><a href="getting-help.html"><i class="fa fa-check"></i><b>2</b> 获取资源与帮助（重要！）</a><ul>
<li class="chapter" data-level="2.1" data-path="getting-help.html"><a href="getting-help.html#section-2.1"><i class="fa fa-check"></i><b>2.1</b> 论坛类（解答实际操作中的问题）</a></li>
<li class="chapter" data-level="2.2" data-path="getting-help.html"><a href="getting-help.html#referencefunctionpackage"><i class="fa fa-check"></i><b>2.2</b> Reference类（查找特定的function/package的用法，就像查字典一样）</a></li>
<li class="chapter" data-level="2.3" data-path="getting-help.html"><a href="getting-help.html#section-2.3"><i class="fa fa-check"></i><b>2.3</b> 教程和书籍类（用来系统地学习）</a></li>
<li class="chapter" data-level="2.4" data-path="getting-help.html"><a href="getting-help.html#-cheat-sheets"><i class="fa fa-check"></i><b>2.4</b> 速查表 (Cheat sheets)（用来贴墙上）</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch2.html"><a href="ch2.html"><i class="fa fa-check"></i><b>3</b> RStudio界面介绍，基本操作，和创建新项目</a><ul>
<li class="chapter" data-level="3.1" data-path="ch2.html"><a href="ch2.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 界面</a><ul>
<li class="chapter" data-level="3.1.1" data-path="ch2.html"><a href="ch2.html#section-3.1.1"><i class="fa fa-check"></i><b>3.1.1</b> 概览</a></li>
<li class="chapter" data-level="3.1.2" data-path="ch2.html"><a href="ch2.html#console"><i class="fa fa-check"></i><b>3.1.2</b> 左下角：Console（控制台）</a></li>
<li class="chapter" data-level="3.1.3" data-path="ch2.html"><a href="ch2.html#source"><i class="fa fa-check"></i><b>3.1.3</b> 左上角：Source（源）</a></li>
<li class="chapter" data-level="3.1.4" data-path="ch2.html"><a href="ch2.html#environment"><i class="fa fa-check"></i><b>3.1.4</b> 右上角：Environment（环境），</a></li>
<li class="chapter" data-level="3.1.5" data-path="ch2.html"><a href="ch2.html#plotshelpfilespackages"><i class="fa fa-check"></i><b>3.1.5</b> 右下角：Plots（绘图），Help（帮助），Files（文件）和Packages（包）</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ch2.html"><a href="ch2.html#section-3.2"><i class="fa fa-check"></i><b>3.2</b> 基本操作</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ch2.html"><a href="ch2.html#section-3.2.1"><i class="fa fa-check"></i><b>3.2.1</b> 执行代码</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch2.html"><a href="ch2.html#manage"><i class="fa fa-check"></i><b>3.2.2</b> 记录和管理代码</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch2.html"><a href="ch2.html#r-script"><i class="fa fa-check"></i><b>3.2.3</b> 写/保存/运行R script</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch2.html"><a href="ch2.html#section-3.2.4"><i class="fa fa-check"></i><b>3.2.4</b> 关于换行</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>4</b> 安装和使用packages (包)</a><ul>
<li class="chapter" data-level="4.1" data-path="packages.html"><a href="packages.html#package"><i class="fa fa-check"></i><b>4.1</b> Package是什么，为什么使用它们？</a></li>
<li class="chapter" data-level="4.2" data-path="packages.html"><a href="packages.html#packages"><i class="fa fa-check"></i><b>4.2</b> 如何安装packages</a></li>
<li class="chapter" data-level="4.3" data-path="packages.html"><a href="packages.html#packages"><i class="fa fa-check"></i><b>4.3</b> 如何使用packages</a></li>
<li class="chapter" data-level="4.4" data-path="packages.html"><a href="packages.html#section-4.4"><i class="fa fa-check"></i><b>4.4</b> 其它</a><ul>
<li class="chapter" data-level="4.4.1" data-path="packages.html"><a href="packages.html#require-and-library"><i class="fa fa-check"></i><b>4.4.1</b> <code>library()</code>和<code>require</code>的区别；如何使用一行指令读取多个packages</a></li>
<li class="chapter" data-level="4.4.2" data-path="packages.html"><a href="packages.html#Bioconductor"><i class="fa fa-check"></i><b>4.4.2</b> 安装Bioconductor packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html"><i class="fa fa-check"></i><b>5</b> 向量，逻辑，循环和函数</a><ul>
<li class="chapter" data-level="5.1" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.1"><i class="fa fa-check"></i><b>5.1</b> 向量的概念，操作和优越性</a><ul>
<li class="chapter" data-level="5.1.1" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#create-vector"><i class="fa fa-check"></i><b>5.1.1</b> 创建向量（赋值）</a></li>
<li class="chapter" data-level="5.1.2" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#indexing"><i class="fa fa-check"></i><b>5.1.2</b> 索引/取子集 (indexing/subsetting)</a></li>
<li class="chapter" data-level="5.1.3" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.1.3"><i class="fa fa-check"></i><b>5.1.3</b> 生成器</a></li>
<li class="chapter" data-level="5.1.4" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.1.4"><i class="fa fa-check"></i><b>5.1.4</b> 向量的其它操作</a></li>
<li class="chapter" data-level="5.1.5" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#youyuexing"><i class="fa fa-check"></i><b>5.1.5</b> R向量的优越性</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#-data-types"><i class="fa fa-check"></i><b>5.2</b> 数据类型 (Data Types)</a></li>
<li class="chapter" data-level="5.3" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.3"><i class="fa fa-check"></i><b>5.3</b> 数学表达和运算</a><ul>
<li class="chapter" data-level="5.3.1" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.3.1"><i class="fa fa-check"></i><b>5.3.1</b> 数的表达</a></li>
<li class="chapter" data-level="5.3.2" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#arithmetic"><i class="fa fa-check"></i><b>5.3.2</b> 运算</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#logical-operation"><i class="fa fa-check"></i><b>5.4</b> 逻辑</a><ul>
<li class="chapter" data-level="5.4.1" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#logical-values"><i class="fa fa-check"></i><b>5.4.1</b> Logical Values（逻辑值）</a></li>
<li class="chapter" data-level="5.4.2" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#logical-operations"><i class="fa fa-check"></i><b>5.4.2</b> Logical Operations（逻辑运算）</a></li>
<li class="chapter" data-level="5.4.3" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.4.3"><i class="fa fa-check"></i><b>5.4.3</b> 逻辑运算详解</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.5"><i class="fa fa-check"></i><b>5.5</b> 判断和循环（控制流程）</a><ul>
<li class="chapter" data-level="5.5.1" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#if-else-else-if-"><i class="fa fa-check"></i><b>5.5.1</b> <code>if</code>, <code>else</code>, <code>else if</code> 语句</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.6"><i class="fa fa-check"></i><b>5.6</b> 函数</a><ul>
<li class="chapter" data-level="5.6.1" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#abbr"><i class="fa fa-check"></i><b>5.6.1</b> 调用函数时的简写</a></li>
<li class="chapter" data-level="5.6.2" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#..."><i class="fa fa-check"></i><b>5.6.2</b> 关于<code>...</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#section-5.7"><i class="fa fa-check"></i><b>5.7</b> 简易的统计学计算</a><ul>
<li class="chapter" data-level="5.7.1" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#t"><i class="fa fa-check"></i><b>5.7.1</b> t分布</a></li>
<li class="chapter" data-level="5.7.2" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#z"><i class="fa fa-check"></i><b>5.7.2</b> z分布</a></li>
<li class="chapter" data-level="5.7.3" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#t"><i class="fa fa-check"></i><b>5.7.3</b> t检验</a></li>
<li class="chapter" data-level="5.7.4" data-path="vectors-logicals-and-functions.html"><a href="vectors-logicals-and-functions.html#chi2-"><i class="fa fa-check"></i><b>5.7.4</b> <span class="math inline">\(\chi^2\)</span> 检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tibble.html"><a href="tibble.html"><i class="fa fa-check"></i><b>6</b> dataframe（数据框）和tibble</a><ul>
<li class="chapter" data-level="6.1" data-path="tibble.html"><a href="tibble.html#dataframetibble"><i class="fa fa-check"></i><b>6.1</b> 查看dataframe/tibble并了解它们的结构</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tibble.html"><a href="tibble.html#dataframetibble"><i class="fa fa-check"></i><b>6.1.1</b> dataframe/tibble的基本概念</a></li>
<li class="chapter" data-level="6.1.2" data-path="tibble.html"><a href="tibble.html#section-6.1.2"><i class="fa fa-check"></i><b>6.1.2</b> 查看更多数据</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tibble.html"><a href="tibble.html#tibble"><i class="fa fa-check"></i><b>6.2</b> tibble的创建和基础操作</a><ul>
<li class="chapter" data-level="6.2.1" data-path="tibble.html"><a href="tibble.html#tibble"><i class="fa fa-check"></i><b>6.2.1</b> 创建tibble</a></li>
<li class="chapter" data-level="6.2.2" data-path="tibble.html"><a href="tibble.html#section-6.2.2"><i class="fa fa-check"></i><b>6.2.2</b> 取子集（抓取行，列）</a></li>
<li class="chapter" data-level="6.2.3" data-path="tibble.html"><a href="tibble.html#factor"><i class="fa fa-check"></i><b>6.2.3</b> 关于Factor</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tibble.html"><a href="tibble.html#list-arraymatrix"><i class="fa fa-check"></i><b>6.3</b> 进阶内容：list, array和matrix</a><ul>
<li class="chapter" data-level="6.3.1" data-path="tibble.html"><a href="tibble.html#list"><i class="fa fa-check"></i><b>6.3.1</b> list（列表）简介</a></li>
<li class="chapter" data-level="6.3.2" data-path="tibble.html"><a href="tibble.html#base-r-dataframe--tidyverse-tibble"><i class="fa fa-check"></i><b>6.3.2</b> Base R dataframe 和 Tidyverse tibble的区别</a></li>
<li class="chapter" data-level="6.3.3" data-path="tibble.html"><a href="tibble.html#arraymatrix"><i class="fa fa-check"></i><b>6.3.3</b> array（数组）和matrix（矩阵）简介</a></li>
<li class="chapter" data-level="6.3.4" data-path="tibble.html"><a href="tibble.html#matricesarrays"><i class="fa fa-check"></i><b>6.3.4</b> 给matrices和arrays命名</a></li>
<li class="chapter" data-level="6.3.5" data-path="tibble.html"><a href="tibble.html#apply"><i class="fa fa-check"></i><b>6.3.5</b> <code>apply</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>7</b> 使用ggplot绘图</a><ul>
<li class="chapter" data-level="7.1" data-path="graphics.html"><a href="graphics.html#section-7.1"><i class="fa fa-check"></i><b>7.1</b> 哲理</a></li>
<li class="chapter" data-level="7.2" data-path="graphics.html"><a href="graphics.html#section-7.2"><i class="fa fa-check"></i><b>7.2</b> 基础</a><ul>
<li class="chapter" data-level="7.2.1" data-path="graphics.html"><a href="graphics.html#section-7.2.1"><i class="fa fa-check"></i><b>7.2.1</b> 基本语法</a></li>
<li class="chapter" data-level="7.2.2" data-path="graphics.html"><a href="graphics.html#section-7.2.2"><i class="fa fa-check"></i><b>7.2.2</b> 图像类型</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="graphics.html"><a href="graphics.html#section-7.3"><i class="fa fa-check"></i><b>7.3</b> 进阶</a><ul>
<li class="chapter" data-level="7.3.1" data-path="graphics.html"><a href="graphics.html#section-7.3.1"><i class="fa fa-check"></i><b>7.3.1</b> 逐层作图</a></li>
<li class="chapter" data-level="7.3.2" data-path="graphics.html"><a href="graphics.html#section-7.3.2"><i class="fa fa-check"></i><b>7.3.2</b> 尺寸，轴，和图例</a></li>
<li class="chapter" data-level="7.3.3" data-path="graphics.html"><a href="graphics.html#section-7.3.3"><i class="fa fa-check"></i><b>7.3.3</b> 位置</a></li>
<li class="chapter" data-level="7.3.4" data-path="graphics.html"><a href="graphics.html#section-7.3.4"><i class="fa fa-check"></i><b>7.3.4</b> 背景/主题的修改</a></li>
<li class="chapter" data-level="7.3.5" data-path="graphics.html"><a href="graphics.html#ggplot"><i class="fa fa-check"></i><b>7.3.5</b> 与ggplot编程</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="graphics.html"><a href="graphics.html#base-r"><i class="fa fa-check"></i><b>7.4</b> 附：Base R中的作图</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="wrangle.html"><a href="wrangle.html"><i class="fa fa-check"></i><b>8</b> 数据处理</a><ul>
<li class="chapter" data-level="8.1" data-path="wrangle.html"><a href="wrangle.html#untidy-datatidy-data"><i class="fa fa-check"></i><b>8.1</b> 把“untidy data”整成“tidy data”</a><ul>
<li class="chapter" data-level="8.1.1" data-path="wrangle.html"><a href="wrangle.html#untidy-data"><i class="fa fa-check"></i><b>8.1.1</b> “untidy data”的主要问题</a></li>
<li class="chapter" data-level="8.1.2" data-path="wrangle.html"><a href="wrangle.html#section-8.1.2"><i class="fa fa-check"></i><b>8.1.2</b> 解决方案</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="wrangle.html"><a href="wrangle.html#section-8.2"><i class="fa fa-check"></i><b>8.2</b> 数据的导入和导出</a><ul>
<li class="chapter" data-level="8.2.1" data-path="wrangle.html"><a href="wrangle.html#data-import"><i class="fa fa-check"></i><b>8.2.1</b> 导入</a></li>
<li class="chapter" data-level="8.2.2" data-path="wrangle.html"><a href="wrangle.html#section-8.2.2"><i class="fa fa-check"></i><b>8.2.2</b> 导出</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>9</b> 与Python的联合使用</a><ul>
<li class="chapter" data-level="9.1" data-path="python.html"><a href="python.html#rpython-reticulate"><i class="fa fa-check"></i><b>9.1</b> 在R中使用Python: <code>reticulate</code></a></li>
<li class="chapter" data-level="9.2" data-path="python.html"><a href="python.html#pythonr-rpy"><i class="fa fa-check"></i><b>9.2</b> 在Python中使用R: <code>rpy</code></a></li>
<li class="chapter" data-level="9.3" data-path="python.html"><a href="python.html#beaker-notebook"><i class="fa fa-check"></i><b>9.3</b> Beaker Notebook</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibiolography.html"><a href="bibiolography.html"><i class="fa fa-check"></i>Bibiolography</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R与tidyverse——数据分析入门</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tibble" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> dataframe（数据框）和tibble</h1>
<div id="dataframetibble" class="section level2">
<h2><span class="header-section-number">6.1</span> 查看dataframe/tibble并了解它们的结构</h2>
<div id="dataframetibble" class="section level3">
<h3><span class="header-section-number">6.1.1</span> dataframe/tibble的基本概念</h3>
<p>dataframe是R中存储复杂数据的格式，它直观易操作。tibble是tidyverse的一部分，它是dataframe的进化版，功能更强大，更易操作。</p>
<p>我们来看个例子：</p>
<p>首先加载tidyverse：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)</code></pre>
<p><strong>以后每次跟着本书使用R的时候，都要先加载tidyverse，不再重复提醒了。</strong></p>
<p>tidyverse中自带一些范例数据，比如我们输入：</p>
<pre class="sourceCode r"><code class="sourceCode r">mpg</code></pre>
<p><img src="img/tibble-intro.png" width="1279" /></p>
<p>这张图是重中之重。一个正确的dataframe/tibble，每一行代表的是一个observation（硬翻译的话是“观测单位”，但是我觉得这个翻译不好），每一列代表的是一个variable（变量），且同一个变量的数据类型必须一样<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>。像这样的数据被称为“tidy data”（“整齐的数据”）。虽然看起来简单，直观，理所当然，但是现实中上人们经常会做出“不整齐”的数据。把不整齐的数据弄整齐是下一章的重点。</p>
</div>
<div id="section-6.1.2" class="section level3">
<h3><span class="header-section-number">6.1.2</span> 查看更多数据</h3>
<p>R默认显示dataframe/tibble的前10行。如果想看最后6行，可以使用<code>tail()</code>函数，比如：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(mpg)</code></pre>
<pre><code>## # A tibble: 6 x 11
##   manufacturer model  displ  year   cyl trans drv     cty   hwy fl    class
##   &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1 volkswagen   passat   1.8  1999     4 auto… f        18    29 p     mids…
## 2 volkswagen   passat   2    2008     4 auto… f        19    28 p     mids…
## 3 volkswagen   passat   2    2008     4 manu… f        21    29 p     mids…
## 4 volkswagen   passat   2.8  1999     6 auto… f        16    26 p     mids…
## 5 volkswagen   passat   2.8  1999     6 manu… f        18    26 p     mids…
## 6 volkswagen   passat   3.6  2008     6 auto… f        17    26 p     mids…</code></pre>
<p>若要从头到尾查看全部数据，可以使用<code>View</code>函数：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">View</span>(mpg)</code></pre>
</div>
</div>
<div id="tibble" class="section level2">
<h2><span class="header-section-number">6.2</span> tibble的创建和基础操作</h2>
<div id="tibble" class="section level3">
<h3><span class="header-section-number">6.2.1</span> 创建tibble</h3>
<div id="tibble" class="section level4">
<h4><span class="header-section-number">6.2.1.1</span> 手动输入数据以创建tibble</h4>
<p>使用<code>tibble</code>函数，按以下格式创建tibble. 换行不是必须的，但是换行会看得更清楚。如果换行，不要忘记行末的逗号。</p>
<pre class="sourceCode r"><code class="sourceCode r">my_tibble_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(
                <span class="dt">nums =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),
                <span class="dt">chars =</span> <span class="kw">c</span>(<span class="st">&quot;hej&quot;</span>, <span class="st">&quot;你好&quot;</span>, <span class="st">&quot;こんにちは&quot;</span>),
                <span class="dt">cplxnums =</span> <span class="kw">c</span>(<span class="st">&quot;4+8i&quot;</span>, <span class="st">&quot;3+5i&quot;</span>, <span class="st">&quot;3+4i&quot;</span>)
                )
my_tibble_<span class="dv">1</span></code></pre>
<pre><code>## # A tibble: 3 x 3
##    nums chars      cplxnums
##   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;   
## 1     4 hej        4+8i    
## 2     5 你好       3+5i    
## 3     6 こんにちは 3+4i</code></pre>
<p>类似地，可以从现有的vector创建。<strong>所有的变量长度必须一样。</strong></p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">211</span>,<span class="dv">23</span>,<span class="dv">45</span>)
z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">32</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">my_tibble_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">v1 =</span> x, <span class="dt">v2 =</span> y)
my_tibble_<span class="dv">2</span></code></pre>
<pre><code>## # A tibble: 3 x 2
##      v1    v2
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1   211
## 2     4    23
## 3     5    45</code></pre>
<p>而试图把<code>x</code>和<code>z</code>做成tibble就会报错：</p>
<pre class="sourceCode r"><code class="sourceCode r">my_tibble_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">w1 =</span> x, <span class="dt">w2 =</span> z)

 <span class="co"># Error: Tibble columns must have consistent lengths, only values of length one are recycled: * Length 2: Column `w2` * Length 3: Column `w1`</span></code></pre>
</div>
<div id="dataframetibble" class="section level4">
<h4><span class="header-section-number">6.2.1.2</span> 把dataframe转换成一个tibble</h4>
<pre class="sourceCode r"><code class="sourceCode r">d1 &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(d) <span class="co">#其中d是一个dataframe</span></code></pre>
</div>
<div id="tibble" class="section level4">
<h4><span class="header-section-number">6.2.1.3</span> 从外部数据创建tibble</h4>
<p>参见第<a href="wrangle.html#data-import">8.2.1</a>节（数据的导入）</p>
</div>
</div>
<div id="section-6.2.2" class="section level3">
<h3><span class="header-section-number">6.2.2</span> 取子集（抓取行，列）</h3>
<div id="single-column" class="section level4">
<h4><span class="header-section-number">6.2.2.1</span> 抓取单列</h4>
<p>抓取单列很简单，也很常用（比如我们只想从一个大的tibble中抓两个变量研究它们之间的关系）。 有两个符号可以用于抓取列，<code>$</code>（仅用于变量名称）与<code>[[]]</code>（变量名称或索引）。还是以<code>mpg</code>为例，假设我们要抓取第3列 (<code>displ</code>)：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">########################</span>
<span class="co">#通过变量名称抓取：</span>
mpg[[<span class="st">&quot;displ&quot;</span>]]
<span class="co">#或</span>
mpg<span class="op">$</span>displ <span class="co">#一般，在RStudio中此方法最方便，因为打出“$”之后会自动提示变量名。</span>

<span class="co">########################</span>
<span class="co">#通过索引抓取：</span>
mpg[[<span class="dv">3</span>]]</code></pre>
<p>以上三种方法都应得到同样的结果（是一个vector）：</p>
<pre><code>##  [1] 1.8 1.8 2.0 2.0 2.8 2.8 3.1 1.8 1.8 2.0 2.0 2.8 2.8 3.1 3.1 2.8 3.1
## [18] 4.2 5.3 5.3</code></pre>
<p>如果使用单方括号，得到的是一个tibble（试试<code>mpg[3]</code>）这个特性在第<a href="tibble.html#dataframe-subsetting">6.3.1.3</a>节中有解释。</p>
</div>
<div id="section-6.2.2.2" class="section level4">
<h4><span class="header-section-number">6.2.2.2</span> 抓取多列</h4>
<p>有时候，一个tibble中含有很多冗余信息，我们可能想把感兴趣的几个变量抓出来做一个新tibble. 这时<code>select()</code>函数最为方便。可以用变量名称或者索引来抓取。比如：</p>
<pre class="sourceCode r"><code class="sourceCode r">mpg_new &lt;-<span class="st"> </span><span class="kw">select</span>(mpg, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>)
<span class="co">#等同于</span>
mpg_new &lt;-<span class="st"> </span><span class="kw">select</span>(mpg, displ, year, cyl, cty, hwy)

mpg_new</code></pre>
<pre><code>## # A tibble: 234 x 5
##    displ  year   cyl   cty   hwy
##    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1   1.8  1999     4    18    29
##  2   1.8  1999     4    21    29
##  3   2    2008     4    20    31
##  4   2    2008     4    21    30
##  5   2.8  1999     6    16    26
##  6   2.8  1999     6    18    26
##  7   3.1  2008     6    18    27
##  8   1.8  1999     4    18    26
##  9   1.8  1999     4    16    25
## 10   2    2008     4    20    28
## # … with 224 more rows</code></pre>
<p>base</p>
</div>
<div id="filter" class="section level4">
<h4><span class="header-section-number">6.2.2.3</span> 通过<code>filter()</code>，抓取满足某条件的行</h4>
<p>通过<code>filter()</code>，我们可以过滤出某个或多个变量满足某种条件的observations. 如果你还不熟悉逻辑运算，请看第<a href="vectors-logicals-and-functions.html#logical-operations">5.4.2</a>节</p>
<p>假设我们只想看<code>mpg</code>中的奥迪品牌的，排量大于等于2且小于4的车辆的数据：</p>
<pre class="sourceCode r"><code class="sourceCode r">mpg_audi_displ2to4 &lt;-<span class="st"> </span><span class="kw">filter</span>(mpg, manufacturer <span class="op">==</span><span class="st"> &quot;audi&quot;</span>, displ <span class="op">&gt;=</span><span class="st"> </span><span class="fl">2.5</span> <span class="op">&amp;</span><span class="st"> </span>displ <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>)

mpg_audi_displ2to4</code></pre>
<pre><code>## # A tibble: 9 x 11
##   manufacturer model  displ  year   cyl trans drv     cty   hwy fl    class
##   &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1 audi         a4       2.8  1999     6 auto… f        16    26 p     comp…
## 2 audi         a4       2.8  1999     6 manu… f        18    26 p     comp…
## 3 audi         a4       3.1  2008     6 auto… f        18    27 p     comp…
## 4 audi         a4 qu…   2.8  1999     6 auto… 4        15    25 p     comp…
## 5 audi         a4 qu…   2.8  1999     6 manu… 4        17    25 p     comp…
## 6 audi         a4 qu…   3.1  2008     6 auto… 4        17    25 p     comp…
## 7 audi         a4 qu…   3.1  2008     6 manu… 4        15    25 p     comp…
## 8 audi         a6 qu…   2.8  1999     6 auto… 4        15    24 p     mids…
## 9 audi         a6 qu…   3.1  2008     6 auto… 4        17    25 p     mids…</code></pre>
</div>
<div id="slice" class="section level4">
<h4><span class="header-section-number">6.2.2.4</span> 用<code>slice()</code>，通过行数（索引）抓取行。</h4>
<pre class="sourceCode r"><code class="sourceCode r">mpg_1to6 &lt;-<span class="st"> </span><span class="kw">slice</span>(mpg, <span class="dv">21</span><span class="op">:</span><span class="dv">26</span>) <span class="co"># 抓取mpg的第21行至26行</span>
mpg_1to6</code></pre>
<pre><code>## # A tibble: 6 x 11
##   manufacturer model  displ  year   cyl trans drv     cty   hwy fl    class
##   &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1 chevrolet    c1500…   5.3  2008     8 auto… r        14    20 r     suv  
## 2 chevrolet    c1500…   5.7  1999     8 auto… r        13    17 r     suv  
## 3 chevrolet    c1500…   6    2008     8 auto… r        12    17 r     suv  
## 4 chevrolet    corve…   5.7  1999     8 manu… r        16    26 p     2sea…
## 5 chevrolet    corve…   5.7  1999     8 auto… r        15    23 p     2sea…
## 6 chevrolet    corve…   6.2  2008     8 manu… r        16    26 p     2sea…</code></pre>
<p>我觉得<code>slice()</code>更实际的用途是随机选择个体：</p>
<pre class="sourceCode r"><code class="sourceCode r">mpg_random4 &lt;-<span class="st"> </span><span class="kw">slice</span>(mpg, <span class="kw">sample</span>(<span class="kw">length</span>(mpg[[<span class="dv">1</span>]]), <span class="dv">4</span>)) <span class="co"># 随机四辆车</span>
mpg_random4</code></pre>
<pre><code>## # A tibble: 4 x 11
##   manufacturer model  displ  year   cyl trans drv     cty   hwy fl    class
##   &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1 subaru       impre…   2.5  1999     4 auto… 4        19    26 r     subc…
## 2 volkswagen   passat   2.8  1999     6 manu… f        18    26 p     mids…
## 3 ford         exped…   5.4  2008     8 auto… r        12    18 r     suv  
## 4 toyota       camry…   2.2  1999     4 auto… f        21    27 r     comp…</code></pre>
</div>
</div>
<div id="factor" class="section level3">
<h3><span class="header-section-number">6.2.3</span> 关于Factor</h3>
<p>有时候，我们的变量是以文字的形式呈现，但是它们不是单纯的文字，而是有大小的差别，或是能以一定顺序排列，比如十二个月份 (Jan, Feb, …)，成绩的“优、良、中、差”，衣服的尺寸 (XS, S, M, XL, …). 假设我们在做客户满意度调查，七位客户的反馈是</p>
<pre class="sourceCode r"><code class="sourceCode r">满意度_v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;满意&quot;</span>, <span class="st">&quot;非常满意&quot;</span>, <span class="st">&quot;满意&quot;</span>, <span class="st">&quot;不满意&quot;</span>, <span class="st">&quot;满意&quot;</span>, <span class="st">&quot;非常不满&quot;</span>,  <span class="st">&quot;不满意&quot;</span>)</code></pre>
<p>我们试图用<code>sort()</code>把七个反馈按满意度从小到大排列：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sort</span>(满意度_v)</code></pre>
<pre><code>## [1] &quot;不满意&quot;   &quot;不满意&quot;   &quot;满意&quot;     &quot;满意&quot;     &quot;满意&quot;     &quot;非常不满&quot;
## [7] &quot;非常满意&quot;</code></pre>
<p>可见其排序并不是有意义的。（因为默认英语根据’abcde…’排序，中文根据笔画排序）</p>
<p>我们可以把这个vector做成factor，并用参数<code>levels</code>规定排序顺序：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 按照惯例，小的值在前，大的在后；“非常不满”应为满意度最低的值。</span>
满意度_f &lt;-<span class="st"> </span><span class="kw">factor</span>(满意度_v, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;非常不满&quot;</span>, <span class="st">&quot;不满意&quot;</span>, <span class="st">&quot;满意&quot;</span>, <span class="st">&quot;非常满意&quot;</span>))
<span class="kw">sort</span>(满意度_f)</code></pre>
<pre><code>## [1] 非常不满 不满意   不满意   满意     满意     满意     非常满意
## Levels: 非常不满 不满意 满意 非常满意</code></pre>
<p>这样排序就是正确的了。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(满意度_f) <span class="co"># &quot;factor&quot;</span>
<span class="kw">is.vector</span>(满意度_f) <span class="co"># FALSE</span></code></pre>
</div>
</div>
<div id="list-arraymatrix" class="section level2">
<h2><span class="header-section-number">6.3</span> 进阶内容：list, array和matrix</h2>
<p>这一节为进阶内容，不用看。可以直接跳到下一章（第<a href="graphics.html#graphics">7</a></p>
<p>其中的很多操作和dataframe或tibble中的操作是等效的。一般，tibble中的操作更直观，更容易上手。</p>
<div id="list" class="section level3">
<h3><span class="header-section-number">6.3.1</span> list（列表）简介</h3>
<p>R中的list是一种特殊的数据存储形式。使用<code>list()</code>函数来创建lists.</p>
<p>尝试对lists和vectors使用<code>is.vector()</code>, <code>is.list()</code>, <code>is.atomic()</code>和<code>is.recursive()</code>函数，你会发现list虽然也是“vector”，但我们一般说的“vector”都是指只能存储一种数据类型的atomic vector；而lists是recursive vector.</p>
<p>这意味着<strong>一个list能存储多种类型的数据，且可以包含子list</strong>。list中的每个元素可以是<strong>任何R中的物件</strong> (object)：除了常用的 (atomic) vector和另外一个（子）list以外，还可以有dataframe/tibble和函数：</p>
<pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;あ&quot;</span>), <span class="kw">list</span>(<span class="dv">1</span><span class="op">+</span>3i, <span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">NA</span>, <span class="ot">TRUE</span>)), 
          <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;阿拉木图&quot;</span>, <span class="st">&quot;什切青&quot;</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)),
          t.test)
y</code></pre>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] &quot;a&quot;  &quot;あ&quot;
## 
## [[3]]
## [[3]][[1]]
## [1] 1+3i
## 
## [[3]][[2]]
## [1] FALSE    NA  TRUE
## 
## 
## [[4]]
## # A tibble: 2 x 2
##   x            y
##   &lt;chr&gt;    &lt;dbl&gt;
## 1 阿拉木图     2
## 2 什切青       3
## 
## [[5]]
## function (x, ...) 
## UseMethod(&quot;t.test&quot;)
## &lt;bytecode: 0x7fd19308c318&gt;
## &lt;environment: namespace:stats&gt;</code></pre>
<div id="list" class="section level4">
<h4><span class="header-section-number">6.3.1.1</span> list的索引/取子集</h4>
<p>使用上面的例子：</p>
<pre class="sourceCode r"><code class="sourceCode r">y[<span class="dv">2</span>] <span class="co"># 使用单方括号，得到的是一个只有一个list元素的list</span></code></pre>
<pre><code>## [[1]]
## [1] &quot;a&quot;  &quot;あ&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">y[[<span class="dv">2</span>]] <span class="co"># 使用双方括号，得到的是一个vector</span></code></pre>
<pre><code>## [1] &quot;a&quot;  &quot;あ&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">y[[<span class="dv">3</span>]][[<span class="dv">2</span>]] <span class="co"># 得到的也是一个vector；母list的索引在前，子list的在后</span></code></pre>
<pre><code>## [1] FALSE    NA  TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">y[[<span class="dv">3</span>]] <span class="co"># 这个位置包含两个子list，因此得到一个有两个list元素的list</span></code></pre>
<pre><code>## [[1]]
## [1] 1+3i
## 
## [[2]]
## [1] FALSE    NA  TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">y[[<span class="dv">3</span>]][[<span class="dv">2</span>]][<span class="dv">2</span>] <span class="co"># 得到vector时，直接在后面用单方括号</span></code></pre>
<pre><code>## [1] NA</code></pre>
<p>list里的元素可以有名字；被命名的元素可以通过<code>$</code>符号抓取：</p>
<pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">z2 =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>))
z <span class="co"># `[[2]]`被`$z2`所取代</span></code></pre>
<pre><code>## [[1]]
## [1] 1 3
## 
## $z2
## [1] 4 5 6
## 
## [[3]]
## [1] &quot;a&quot; &quot;b&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">z<span class="op">$</span>z2 <span class="op">==</span><span class="st"> </span>z[[<span class="dv">2</span>]] <span class="co"># `z[[2]]`仍然是可用的，结果和`z$z2`一样</span></code></pre>
<pre><code>## [1] TRUE TRUE TRUE</code></pre>
</div>
<div id="dataframetibble" class="section level4">
<h4><span class="header-section-number">6.3.1.2</span> Dataframe和tibble的本质</h4>
<p>聪明的你也许已经注意到了，dataframe/tibble<a href="tibble.html#single-column">抓取单列的方法</a>和list的取子集惊人地相似（我曾经的语文老师喜欢调侃抄作业的同学的答案与参考答案“惊人地相似”）。</p>
<p>事实上，dataframe的本质正是list，而tibble也是dataframe（只是进化了一些功能）：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.list</span>(mpg)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(mpg)</code></pre>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
</div>
<div id="dataframe-subsetting" class="section level4">
<h4><span class="header-section-number">6.3.1.3</span> Dataframe/tibble的取子集</h4>
<p>Tibble既有list的特征，也有matrix的特征。</p>
<p>当使用一个参数取子集的时候，比如<code>mpg[[3]]</code>，<code>mpg[[&quot;displ&quot;]]</code>或<code>mpg$displ</code>，tibble表现得像list，其中每一列是一个有命名的list element；</p>
<p>当使用两个参数取子集的时候，比如<code>mpg[3,4]</code>, <code>mpg[3, ]</code>, <code>mpg[ ,4]</code>，tibble表现得像matrix</p>
<pre class="sourceCode r"><code class="sourceCode r">mpg[<span class="dv">3</span>, ]</code></pre>
<pre><code>## # A tibble: 1 x 11
##   manufacturer model displ  year   cyl trans  drv     cty   hwy fl    class
##   &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1 audi         a4        2  2008     4 manua… f        20    31 p     comp…</code></pre>
<p>请查看<a href="https://adv-r.hadley.nz/subsetting.html#simplify-preserve">Advanced R</a>了解更多。</p>
</div>
</div>
<div id="base-r-dataframe--tidyverse-tibble" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Base R dataframe 和 Tidyverse tibble的区别</h3>
<p>你可能已经注意到，上面<code>mpg[3, ]</code>和<code>select(mpg, 3)</code>是等效的；<code>mpg[3, ]</code>显然更精简，那么为什么要使用<code>select()</code>函数呢？</p>
<p>zaocheng<span class="citation">(Gentleman <a href="#ref-Gentleman2009R-Programming-Bioinfo">2009</a>, 33; Wickham <a href="#ref-Wickham:2019">2019</a>)</span></p>
</div>
<div id="arraymatrix" class="section level3">
<h3><span class="header-section-number">6.3.3</span> array（数组）和matrix（矩阵）简介</h3>
<p>Vector是一维的数据。Array是多维的数据。Matrix是二维的数据，因此matrix是array的一种特殊情况。</p>
<p>Dataframe不是matrix（虽然都是方的）. Matrix是二维的，<strong>仅包含数字</strong>的<strong>array</strong>. Dataframe是一个二维的<strong>list</strong>，不同列（即list元素）<strong>可以存储不同的数据类型</strong>。</p>
<p>我们可以用<code>dim()</code>来创建arrays：</p>
<pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">48</span> <span class="co">#创建一个(1,2,3,...24)的numeric vector</span>
<span class="kw">dim</span>(A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">8</span>) <span class="co">#给A assign一个6乘4的dimensions</span>
A</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    1    7   13   19   25   31   37   43
## [2,]    2    8   14   20   26   32   38   44
## [3,]    3    9   15   21   27   33   39   45
## [4,]    4   10   16   22   28   34   40   46
## [5,]    5   11   17   23   29   35   41   47
## [6,]    6   12   18   24   30   36   42   48</code></pre>
<p>可以看到我们创建了一个二维的，array, 因此它也是一个（4行6列的）matrix。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.array</span>(A)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.matrix</span>(A)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>注意24个数字排列的方式。第一个维度是行，所以先把4行排满，随后再使用下一个维度（列），使用第2列继续排4行，就像数字一样，（十进制中）先把个位从零数到9，再使用第二个位数（十位），以此类推。下面三维和四维的例子可能会更清晰。</p>
<p>同时注意最左边和最上边的[1,], [,3]之类的标记。你应该猜出来了，这些是index. 假设你要抓取第五行第三列的数值：</p>
<pre class="sourceCode r"><code class="sourceCode r">A[<span class="dv">5</span>,<span class="dv">3</span>]</code></pre>
<pre><code>## [1] 17</code></pre>
<p>或者第三行的全部数值：</p>
<pre class="sourceCode r"><code class="sourceCode r">A[<span class="dv">3</span>,]</code></pre>
<pre><code>## [1]  3  9 15 21 27 33 39 45</code></pre>
<p>或者第四列的全部数值：</p>
<pre class="sourceCode r"><code class="sourceCode r">A[,<span class="dv">4</span>]</code></pre>
<pre><code>## [1] 19 20 21 22 23 24</code></pre>
<p>接下来我们再看一个三维的例子（还是用1-48）：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">3</span>)
A</code></pre>
<pre><code>## , , 1
## 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    1    3    5    7    9   11   13   15
## [2,]    2    4    6    8   10   12   14   16
## 
## , , 2
## 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]   17   19   21   23   25   27   29   31
## [2,]   18   20   22   24   26   28   30   32
## 
## , , 3
## 
##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]   33   35   37   39   41   43   45   47
## [2,]   34   36   38   40   42   44   46   48</code></pre>
<p>它生成了三个二维的矩阵。在每个2*8的矩阵存储满16个元素后，第三个维度就要加一了。每个矩阵开头的<code>, , x</code>正是第三个维度的值。同理，我们可以生成四维的array：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(A) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">2</span>)
A</code></pre>
<pre><code>## , , 1, 1
## 
##      [,1] [,2] [,3] [,4]
## [1,]    1    4    7   10
## [2,]    2    5    8   11
## [3,]    3    6    9   12
## 
## , , 2, 1
## 
##      [,1] [,2] [,3] [,4]
## [1,]   13   16   19   22
## [2,]   14   17   20   23
## [3,]   15   18   21   24
## 
## , , 1, 2
## 
##      [,1] [,2] [,3] [,4]
## [1,]   25   28   31   34
## [2,]   26   29   32   35
## [3,]   27   30   33   36
## 
## , , 2, 2
## 
##      [,1] [,2] [,3] [,4]
## [1,]   37   40   43   46
## [2,]   38   41   44   47
## [3,]   39   42   45   48</code></pre>
<p>观察每个矩阵开头的<code>, , x, y</code>. x是第三个维度，y是第四个维度。每个二位矩阵存满后，第三个维度（x）加一。x达到上限后，第四个维度（y）再加一。</p>
<p>类似二维矩阵，你可以通过index任意抓取数据，比如：</p>
<pre class="sourceCode r"><code class="sourceCode r">A[ ,<span class="dv">3</span> , , ] <span class="co">#每个矩阵第3列的数据，即所有第二个维度为3的数值</span></code></pre>
<pre><code>## , , 1
## 
##      [,1] [,2]
## [1,]    7   19
## [2,]    8   20
## [3,]    9   21
## 
## , , 2
## 
##      [,1] [,2]
## [1,]   31   43
## [2,]   32   44
## [3,]   33   45</code></pre>
</div>
<div id="matricesarrays" class="section level3">
<h3><span class="header-section-number">6.3.4</span> 给matrices和arrays命名</h3>
<p>假设我们记录了3种药物（chloroquine, artemisinin, doxycycline)
对5种疟原虫(P. falciparum, P. malariae, P. ovale, P. vivax, P. knowlesi)的疗效，其中每个药物对每种疟原虫做6次实验。为了记录数据，我们可以做3个6*5的矩阵：（这里只是举例子，用的是随机生成的数字）</p>
<pre class="sourceCode r"><code class="sourceCode r">B &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#从均匀分布中取100个0到1之间的数</span>
<span class="kw">dim</span>(B) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">3</span>) <span class="co">#注意顺序</span>
B</code></pre>
<pre><code>## , , 1
## 
##           [,1]       [,2]      [,3]      [,4]      [,5]
## [1,] 0.1802897 0.63278814 0.5161717 0.3026248 0.5316644
## [2,] 0.8095911 0.86990748 0.3127848 0.5758396 0.8127192
## [3,] 0.4556011 0.68941866 0.6406969 0.9821695 0.9820575
## [4,] 0.8983427 0.92622632 0.1441258 0.6728608 0.3957969
## [5,] 0.6524955 0.03553176 0.7067941 0.3134378 0.7218979
## [6,] 0.8508967 0.88345933 0.9822389 0.1410342 0.5773331
## 
## , , 2
## 
##             [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 0.008782062 0.2280788 0.9282057 0.3859663 0.7488624
## [2,] 0.295818088 0.3850583 0.8093798 0.1917808 0.3409629
## [3,] 0.072176412 0.3610256 0.1000049 0.6799255 0.8647968
## [4,] 0.045869072 0.8566545 0.7495510 0.6012008 0.4516493
## [5,] 0.818663927 0.2371728 0.3651683 0.9194714 0.7843553
## [6,] 0.347141178 0.9618424 0.9445372 0.8986600 0.9523262
## 
## , , 3
## 
##           [,1]      [,2]      [,3]       [,4]      [,5]
## [1,] 0.5281108 0.3885336 0.3155204 0.70562231 0.4302389
## [2,] 0.1764546 0.6098433 0.6193082 0.96060045 0.5162144
## [3,] 0.9048749 0.6665460 0.5673022 0.68877148 0.1974196
## [4,] 0.6246898 0.7412667 0.8444078 0.45079780 0.3989748
## [5,] 0.4450868 0.7840932 0.8292858 0.53022020 0.4705166
## [6,] 0.7845425 0.3626070 0.6787725 0.01166276 0.1721282</code></pre>
<p>然后我们用<code>dimnames()</code>来命名：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dimnames</span>(B) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;trial.&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>), <span class="kw">c</span>(<span class="st">&#39;P. falciparum&#39;</span>, <span class="st">&#39;P. malariae&#39;</span>, <span class="st">&#39;P. ovale&#39;</span>, <span class="st">&#39;P. vivax&#39;</span>, <span class="st">&#39;P. knowlesi&#39;</span>), <span class="kw">c</span>(<span class="st">&#39;chloroquine&#39;</span>, <span class="st">&#39;artemisinin&#39;</span>, <span class="st">&#39;doxycycline&#39;</span>))
B</code></pre>
<pre><code>## , , chloroquine
## 
##          P. falciparum P. malariae  P. ovale  P. vivax P. knowlesi
## trial. 1     0.1802897  0.63278814 0.5161717 0.3026248   0.5316644
## trial. 2     0.8095911  0.86990748 0.3127848 0.5758396   0.8127192
## trial. 3     0.4556011  0.68941866 0.6406969 0.9821695   0.9820575
## trial. 4     0.8983427  0.92622632 0.1441258 0.6728608   0.3957969
## trial. 5     0.6524955  0.03553176 0.7067941 0.3134378   0.7218979
## trial. 6     0.8508967  0.88345933 0.9822389 0.1410342   0.5773331
## 
## , , artemisinin
## 
##          P. falciparum P. malariae  P. ovale  P. vivax P. knowlesi
## trial. 1   0.008782062   0.2280788 0.9282057 0.3859663   0.7488624
## trial. 2   0.295818088   0.3850583 0.8093798 0.1917808   0.3409629
## trial. 3   0.072176412   0.3610256 0.1000049 0.6799255   0.8647968
## trial. 4   0.045869072   0.8566545 0.7495510 0.6012008   0.4516493
## trial. 5   0.818663927   0.2371728 0.3651683 0.9194714   0.7843553
## trial. 6   0.347141178   0.9618424 0.9445372 0.8986600   0.9523262
## 
## , , doxycycline
## 
##          P. falciparum P. malariae  P. ovale   P. vivax P. knowlesi
## trial. 1     0.5281108   0.3885336 0.3155204 0.70562231   0.4302389
## trial. 2     0.1764546   0.6098433 0.6193082 0.96060045   0.5162144
## trial. 3     0.9048749   0.6665460 0.5673022 0.68877148   0.1974196
## trial. 4     0.6246898   0.7412667 0.8444078 0.45079780   0.3989748
## trial. 5     0.4450868   0.7840932 0.8292858 0.53022020   0.4705166
## trial. 6     0.7845425   0.3626070 0.6787725 0.01166276   0.1721282</code></pre>
<p><strong>清清楚楚，一目了然。</strong></p>
</div>
<div id="apply" class="section level3">
<h3><span class="header-section-number">6.3.5</span> <code>apply</code></h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(A,<span class="dv">1</span>,sum)</code></pre>
<pre><code>## [1] 376 392 408</code></pre>

</div>
</div>
</div>
<h3>Bibiolography</h3>
<div id="refs" class="references">
<div id="ref-Gentleman2009R-Programming-Bioinfo">
<p>Gentleman, Robert. 2009. <em>R Programming for Bioinformatics</em>. Book. Boca Raton, FL: CRC Press.</p>
</div>
<div id="ref-Wickham:2019">
<p>Wickham, Hadley. 2019. <em>Advanced R</em>. 2nd ed. CRC Press.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p><a href="https://thomaswdinsmore.com/2014/12/15/sas-versus-r-part-two/" class="uri">https://thomaswdinsmore.com/2014/12/15/sas-versus-r-part-two/</a><a href="tibble.html#fnref4" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vectors-logicals-and-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["R与tidyverse——数据分析入门.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
